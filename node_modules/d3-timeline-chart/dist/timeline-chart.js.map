{"version":3,"sources":["timeline-chart.js"],"names":[],"mappings":"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","file":"timeline-chart.js","sourcesContent":["class TimelineChart {\n    constructor(element, data, opts) {\n        let self = this;\n\n        element.classList.add('timeline-chart');\n\n        let options = this.extendOptions(opts);\n\n        let allElements = data.reduce((agg, e) => agg.concat(e.data), []);\n\n        let minDt = d3.min(allElements, this.getPointMinDt);\n        let maxDt = d3.max(allElements, this.getPointMaxDt);\n\n        let elementWidth = options.width || element.clientWidth;\n        let elementHeight = options.height || element.clientHeight;\n\n        let margin = {\n            top: 0,\n            right: 0,\n            bottom: 20,\n            left: 0\n        };\n\n        let width = elementWidth - margin.left - margin.right;\n        let height = elementHeight - margin.top - margin.bottom;\n\n        let groupWidth = 200;\n\n        let x = d3.time.scale()\n            .domain([minDt, maxDt])\n            .range([groupWidth, width]);\n\n        let xAxis = d3.svg.axis()\n            .scale(x)\n            .orient('bottom')\n            .tickSize(-height);\n\n        let zoom = d3.behavior.zoom()\n            .x(x)\n            .on('zoom', zoomed);\n\n        let svg = d3.select(element).append('svg')\n            .attr('width', width + margin.left + margin.right)\n            .attr('height', height + margin.top + margin.bottom)\n            .append('g')\n            .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')')\n            .call(zoom);\n\n        svg.append('defs')\n            .append('clipPath')\n            .attr('id', 'chart-content')\n            .append('rect')\n            .attr('x', groupWidth)\n            .attr('y', 0)\n            .attr('height', height)\n            .attr('width', width - groupWidth)\n\n        svg.append('rect')\n            .attr('class', 'chart-bounds')\n            .attr('x', groupWidth)\n            .attr('y', 0)\n            .attr('height', height)\n            .attr('width', width - groupWidth)\n\n        svg.append('g')\n            .attr('class', 'x axis')\n            .attr('transform', 'translate(0,' + height + ')')\n            .call(xAxis);\n\n        let groupHeight = height / data.length;\n        let groupSection = svg.selectAll('.group-section')\n            .data(data)\n            .enter()\n            .append('line')\n            .attr('class', 'group-section')\n            .attr('x1', 0)\n            .attr('x2', width)\n            .attr('y1', (d, i) => {\n                return groupHeight * (i + 1);\n            })\n            .attr('y2', (d, i) => {\n                return groupHeight * (i + 1);\n            });\n\n        let groupLabels = svg.selectAll('.group-label')\n            .data(data)\n            .enter()\n            .append('text')\n            .attr('class', 'group-label')\n            .attr('x', 0)\n            .attr('y', (d, i) => {\n                return (groupHeight * i) + (groupHeight / 2) + 5.5;\n            })\n            .attr('dx', '0.5em')\n            .text(d => d.label);\n\n        let lineSection = svg.append('line').attr('x1', groupWidth).attr('x2', groupWidth).attr('y1', 0).attr('y2', height).attr('stroke', 'black');\n\n        let groupIntervalItems = svg.selectAll('.group-interval-item')\n            .data(data)\n            .enter()\n            .append('g')\n            .attr('clip-path', 'url(#chart-content)')\n            .attr('class', 'item')\n            .attr('transform', (d, i) => `translate(0, ${groupHeight * i})`)\n            .selectAll('.dot')\n            .data(d => d.data.filter(_ => _.type === TimelineChart.TYPE.INTERVAL))\n            .enter();\n\n        let intervalBarHeight = 0.8 * groupHeight;\n        let intervalBarMargin = (groupHeight - intervalBarHeight) / 2;\n        let intervals = groupIntervalItems\n            .append('rect')\n            .attr('class', withCustom('interval'))\n            .attr('width', (d) => Math.max(options.intervalMinWidth, x(d.to) - x(d.from)))\n            .attr('height', intervalBarHeight)\n            .attr('y', intervalBarMargin)\n            .attr('x', (d) => x(d.from));\n\n        let intervalTexts = groupIntervalItems\n            .append('text')\n            .text(d => d.label)\n            .attr('fill', 'white')\n            .attr('class', withCustom('interval-text'))\n            .attr('y', (groupHeight / 2) + 5)\n            .attr('x', (d) => x(d.from));\n\n        let groupDotItems = svg.selectAll('.group-dot-item')\n            .data(data)\n            .enter()\n            .append('g')\n            .attr('clip-path', 'url(#chart-content)')\n            .attr('class', 'item')\n            .attr('transform', (d, i) => `translate(0, ${groupHeight * i})`)\n            .selectAll('.dot')\n            .data(d => {\n                return d.data.filter(_ => _.type === TimelineChart.TYPE.POINT);\n            })\n            .enter();\n\n        let dots = groupDotItems\n            .append('circle')\n            .attr('class', withCustom('dot'))\n            .attr('cx', d => x(d.at))\n            .attr('cy', groupHeight / 2)\n            .attr('r', 5);\n\n        if (options.tip) {\n            if (d3.tip) {\n                let tip = d3.tip().attr('class', 'd3-tip').html(options.tip);\n                svg.call(tip);\n                dots.on('mouseover', tip.show).on('mouseout', tip.hide)\n            } else {\n                console.error('Please make sure you have d3.tip included as dependency (https://github.com/Caged/d3-tip)');\n            }\n        }\n\n        zoomed();\n\n        function withCustom(defaultClass) {\n            return d => d.customClass ? [d.customClass, defaultClass].join(' ') : defaultClass\n        }\n\n        function zoomed() {\n            if (self.onVizChangeFn && d3.event) {\n                self.onVizChangeFn.call(self, {\n                    scale: d3.event.scale,\n                    translate: d3.event.translate,\n                    domain: x.domain()\n                });\n            }\n\n            svg.select('.x.axis').call(xAxis);\n\n            svg.selectAll('circle.dot').attr('cx', d => x(d.at));\n            svg.selectAll('rect.interval').attr('x', d => x(d.from)).attr('width', d => Math.max(options.intervalMinWidth, x(d.to) - x(d.from)));\n\n            svg.selectAll('.interval-text').attr('x', function(d) {\n                    let positionData = getTextPositionData.call(this, d);\n                    if ((positionData.upToPosition - groupWidth - 10) < positionData.textWidth) {\n                        return positionData.upToPosition;\n                    } else if (positionData.xPosition < groupWidth && positionData.upToPosition > groupWidth) {\n                        return groupWidth;\n                    }\n                    return positionData.xPosition;\n                }).attr('text-anchor', function(d) {\n                    let positionData = getTextPositionData.call(this, d);\n                    if ((positionData.upToPosition - groupWidth - 10) < positionData.textWidth) {\n                        return 'end';\n                    }\n                    return 'start';\n                })\n                .attr('dx', function(d) {\n                    let positionData = getTextPositionData.call(this, d);\n                    if ((positionData.upToPosition - groupWidth - 10) < positionData.textWidth) {\n                        return '-0.5em';\n                    }\n                    return '0.5em';\n                }).text(function(d) {\n                    var positionData = getTextPositionData.call(this, d);\n                    var percent = (positionData.width - options.textTruncateThreshold) / positionData.textWidth;\n                    if (percent < 1) {\n                        if (positionData.width > options.textTruncateThreshold) {\n                            return d.label.substr(0, Math.floor(d.label.length * percent)) + '...';\n                        } else {\n                            return '';\n                        }\n                    }\n\n                    return d.label;\n                });\n\n            function getTextPositionData(d) {\n                this.textSizeInPx = this.textSizeInPx || this.getComputedTextLength();\n                var from = x(d.from);\n                var to = x(d.to);\n                return {\n                    xPosition: from,\n                    upToPosition: to,\n                    width: to - from,\n                    textWidth: this.textSizeInPx\n                }\n            }\n        }\n    }\n    extendOptions(ext = {}) {\n        let defaultOptions = {\n            intervalMinWidth: 8, // px\n            tip: undefined,\n            textTruncateThreshold: 30\n        };\n        Object.keys(ext).map(k => defaultOptions[k] = ext[k]);\n        return defaultOptions;\n    }\n    getPointMinDt(p) {\n        return p.type === TimelineChart.TYPE.POINT ? p.at : p.from;\n    }\n    getPointMaxDt(p) {\n        return p.type === TimelineChart.TYPE.POINT ? p.at : p.to;\n    }\n    onVizChange(fn) {\n        this.onVizChangeFn = fn;\n        return this;\n    }\n}\n\nTimelineChart.TYPE = {\n    POINT: Symbol(),\n    INTERVAL: Symbol()\n};\n\nmodule.exports = TimelineChart;\n"],"sourceRoot":"/source/"}